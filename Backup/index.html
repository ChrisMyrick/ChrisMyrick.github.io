<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>BlazorAspNetCoreHosted</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/site.css" rel="stylesheet" />
    <link rel="manifest" href="manifest.json">
    <link rel="script" href="service-worker.js">
    <meta name="theme-color" content="#052767" />
</head>
<body>
    <app>Loading...</app>

    <script src="_framework/blazor.webassembly.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            console.log('Registering service worker now');
            //navigator.serviceWorker.register('/service-worker.js')
            navigator.serviceWorker.register('/service-worker.js').then(
                function (serviceWorkerRegistration) {
                    serviceWorkerRegistration.pushManager.subscribe().then(
                        function (pushSubscription) {
                            console.log(pushSubscription.subscriptionId);
                            console.log(pushSubscription.endpoint);
                            // The push subscription details needed by the application
                            // server are now available, and can be sent to it using,
                            // for example, an XMLHttpRequest.
                        }, function (error) {
                            // During development it often helps to log errors to the
                            // console. In a production environment it might make sense to
                            // also report information about errors back to the
                            // application server.
                            console.log(error);
                        }
                    );
                });
        }


        this.onpush = function (event) {
            console.log(event.data);
            // From here we can write the data to IndexedDB, send it to any open
            // windows, display a notification, etc.
        }
    </script>
</body>
</html>
